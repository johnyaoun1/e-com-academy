<div class="checkout-page">
  <div class="container">
    <h1>Checkout</h1>

    <div class="checkout-content">
      <div class="checkout-form">
        <!-- Progress Steps -->
        <div class="progress-steps">
          <div class="step" [class.active]="currentStep >= 1" [class.completed]="currentStep > 1">
            <span class="step-number">1</span>
            <span class="step-label">Shipping</span>
          </div>
          <div class="step-line" [class.active]="currentStep > 1"></div>
          <div class="step" [class.active]="currentStep >= 2">
            <span class="step-number">2</span>
            <span class="step-label">Payment</span>
          </div>
        </div>

        <form [formGroup]="checkoutForm">
          <!-- Shipping Step -->
          <div *ngIf="currentStep === 1" formGroupName="shipping" class="form-step">
            <h2>Shipping Information</h2>
            
            <div class="form-row">
              <div class="form-group">
                <label>First Name *</label>
                <input type="text" formControlName="firstName" class="form-control">
              </div>
              <div class="form-group">
                <label>Last Name *</label>
                <input type="text" formControlName="lastName" class="form-control">
              </div>
            </div>

            <div class="form-group">
              <label>Email *</label>
              <input type="email" formControlName="email" class="form-control">
            </div>

            <div class="form-group">
              <label>Phone *</label>
              <input type="tel" formControlName="phone" class="form-control">
            </div>

            <div class="form-group">
              <label>Address *</label>
              <input type="text" formControlName="address" class="form-control">
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>City *</label>
                <input type="text" formControlName="city" class="form-control">
              </div>
              <div class="form-group">
                <label>State *</label>
                <input type="text" formControlName="state" class="form-control">
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Zip Code *</label>
                <input type="text" formControlName="zipCode" class="form-control">
              </div>
              <div class="form-group">
                <label>Country *</label>
                <select formControlName="country" class="form-control">
                  <option value="">Select Country</option>
                  <option value="US">United States</option>
                  <option value="CA">Canada</option>
                  <option value="UK">United Kingdom</option>
                </select>
              </div>
            </div>

            <div class="form-actions">
              <button type="button" class="btn-secondary" routerLink="/cart">
                Back to Cart
              </button>
              <button type="button" class="btn-primary" (click)="nextStep()">
                Continue to Payment
              </button>
            </div>
          </div>

          <!-- Payment Step -->
          <div *ngIf="currentStep === 2" formGroupName="payment" class="form-step">
            <h2>Payment Information</h2>

            <div class="form-group">
              <label>Card Number *</label>
              <input type="text" formControlName="cardNumber" class="form-control" 
                     placeholder="1234 5678 9012 3456">
            </div>

            <div class="form-group">
              <label>Name on Card *</label>
              <input type="text" formControlName="cardName" class="form-control">
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Expiry Date *</label>
                <input type="text" formControlName="expiryDate" class="form-control" 
                       placeholder="MM/YY">
              </div>
              <div class="form-group">
                <label>CVV *</label>
                <input type="text" formControlName="cvv" class="form-control" 
                       placeholder="123">
              </div>
            </div>

            <div class="form-actions">
              <button type="button" class="btn-secondary" (click)="previousStep()">
                Back
              </button>
              <button type="button" class="btn-primary" (click)="placeOrder()">
                Place Order
              </button>
            </div>
          </div>
        </form>
      </div>

      <!-- Order Summary -->
      <div class="order-summary">
        <h2>Order Summary</h2>
        
        <div class="order-items">
          <div class="order-item" *ngFor="let item of cartItems$ | async">
            <img [src]="item.product.image" [alt]="item.product.title">
            <div class="item-info">
              <p class="item-title">{{ item.product.title | truncate:50 }}</p>
              <p class="item-quantity">Qty: {{ item.quantity }}</p>
            </div>
            <p class="item-price">{{ (item.product.price * item.quantity) | currencyFormat }}</p>
          </div>
        </div>

        <div class="summary-totals">
          <div class="summary-row">
            <span>Subtotal</span>
            <span>{{ cartTotal | currencyFormat }}</span>
          </div>
          <div class="summary-row">
            <span>Shipping</span>
            <span>Free</span>
          </div>
          <div class="summary-row">
            <span>Tax</span>
            <span>{{ (cartTotal * 0.08) | currencyFormat }}</span>
          </div>
          <div class="summary-row total">
            <span>Total</span>
            <span>{{ (cartTotal * 1.08) | currencyFormat }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>